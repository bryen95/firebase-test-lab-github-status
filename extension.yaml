name: test-lab-github-status
version: 0.0.2
specVersion: v1beta

displayName: Firebase Test Lab GitHub Status Reporter

description: >-
  Reports Firebase Test Lab results for GitHub status checks.

author:
  authorName: Bryen Vieira

license: Apache-2.0

sourceUrl: https://github.com/bryen95/firebase-test-lab-github-status

billingRequired: true

resources:
  - name: testLabGitHubStatusUpdate
    type: firebaseextensions.v1beta.v2function
    description: >-
      Firebase Test Lab-triggered function that updates a GitHub commit with the
       success/failure status of a test run
    properties:
      buildConfig:
        runtime: nodejs16
      serviceConfig:
        timeoutSeconds: 10
        availableMemory: 128M
      eventTrigger:
        eventType: google.testing.testMatrix.complete
        triggerRegion: global

params:
  - param: GITHUB_TOKEN
    label: GitHub Personal Access Token
    description: >-
      GitHub token with repo:status scope for updating commit statuses
    type: secret
    required: true
  - param: GITHUB_OWNER
    label: GitHub Organisation Name
    description: >-
      Name of your GitHub organisation (or your username, if a personal account)
    type: string
    required: true
  - param: GITHUB_REPO
    label: GitHub Repository Name
    description: >-
      Name of your GitHub repository
    type: string
    required: true
